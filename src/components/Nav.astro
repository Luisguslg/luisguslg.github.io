---
import Container from "./Container.astro";
import CTAButton from "./CTAButton.astro";
import { site } from "../content/site";

const { nav, cta } = site;
---

<header class="sticky top-0 z-50 border-b border-border bg-bg/75 backdrop-blur supports-[backdrop-filter]:bg-bg/55">
  <Container class="py-3">
    <div class="flex items-center justify-between gap-3">
      <a href="#" class="flex items-center gap-2 font-semibold tracking-tight">
        <span class="inline-flex h-8 w-8 items-center justify-center rounded-lg border border-border bg-card font-mono text-xs">
          LG
        </span>
        <span class="hidden sm:inline">{site.person.name}</span>
      </a>

      <nav class="hidden items-center gap-6 md:flex" aria-label="Secciones">
        {nav.map((item) => (
          <a class="text-sm text-muted hover:text-fg transition-colors" href={item.href}>
            {item.label}
          </a>
        ))}
      </nav>

      <div class="flex items-center gap-2">
        <details class="relative md:hidden">
          <summary class="list-none rounded-lg border border-border bg-card px-3 py-2 text-sm hover:bg-card/80 cursor-pointer">
            Menú
          </summary>
          <div class="absolute right-0 mt-2 w-56 rounded-xl border border-border bg-bg shadow-soft">
            <div class="p-2">
              {nav.map((item) => (
                <a class="block rounded-lg px-3 py-2 text-sm text-muted hover:bg-card/60 hover:text-fg" href={item.href}>
                  {item.label}
                </a>
              ))}
            </div>
          </div>
        </details>

        <button
          type="button"
          class="rounded-lg border border-border bg-card px-3 py-2 text-sm hover:bg-card/80"
          aria-label="Cambiar tema"
          data-theme-toggle
        >
          <span class="font-mono text-xs">Tema</span>
        </button>

        <CTAButton variant="secondary" href="#contact" class="hidden sm:inline-flex">Let’s talk</CTAButton>
        <CTAButton variant="primary" disabled={!cta.cv.available}>
          {cta.cv.label}
        </CTAButton>
      </div>
    </div>
  </Container>
</header>

<script>
  const btn = document.querySelector("[data-theme-toggle]");
  btn?.addEventListener("click", () => {
    const root = document.documentElement;
    const isDark = root.classList.toggle("dark");
    try {
      localStorage.setItem("theme", isDark ? "dark" : "light");
    } catch {}
  });
</script>

